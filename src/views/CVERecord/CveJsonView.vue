<template>
  <div id="cve-json-container">
    <h1 class="title">{{cveId}}</h1>
    <JsonTree :raw="JSON.stringify(record, null, 2)"></JsonTree>
  </div>
</template>

<script>
import _ from 'lodash';
import JsonTree from 'vue-json-tree';

export default ({
  name: 'CVEJsonView',
  components: {
    JsonTree,
  },
  data() {
    return {
      record: {},
      cveId: '',
    };
  },
  created() {
    this.getJSon();
  },
  methods: {
    getJSon() {
      this.cveId = localStorage.getItem('cveId');
      const isArecord = localStorage.getItem('isArecord');
      const recordData = JSON.parse(localStorage.getItem('recordData'));
      const idData = JSON.parse(localStorage.getItem('idData'));

      if (isArecord === 'undefined' || (_.isEmpty(recordData) && _.isEmpty(idData))) {
        this.$router.push('/');
      }
      if ((!_.isUndefined(isArecord) || isArecord === 'true') && !_.isEmpty(recordData)) {
        this.record = recordData;
      } else if ((!_.isUndefined(isArecord) || isArecord === 'false') && !_.isEmpty(idData)) {
        this.record = idData;
      } else {
        this.$router.push('/');
      }
    },
  },
});
</script>

<style lang="scss">
@import '@/assets/style/globals.scss';

.json-tree {
  font-size: 16px !important;
}

.json-tree-value {
  color: $theme-color-primary-darker !important;
  /* unset to show overflown text */
  overflow: unset !important;
  white-space: unset !important;
}
</style>
