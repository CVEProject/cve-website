<template>
  <div class="content">
    <div role="information" class="notification is-info is-light p-3">
      <div class="is-flex" style="justify-content: center;">
          <section class="cve-accordian" style="flex: 0 0 100%;">
              <div class="message" style="background: transparent !important;">
                <div class="message-header p-0"
                  style="background: transparent !important;border-bottom: unset !important">
                  <span class="icon-text">
                    <span class="icon">
                      <p id="infoIconVariousFormts" class="is-hidden">information</p>
                      <font-awesome-icon style="flex: 0 0 40px;" size="1x"  icon="info-circle" role="alert"
                        aria-labelledby="alertIconVariousFormts" aria-hidden="false" />
                    </span>
                    <p class="mr-1">Learn About the Versions Section</p>
                  </span>
                  <button class="button message-header-button" style="background: transparent !important;"
                    @click="isHelpTestShown = !isHelpTestShown">
                      <span class="icon is-small">
                        <p id="expandCollapseVersionsAltText" class="is-hidden">
                          {{isHelpTestShown ? 'expand': 'collapse'}}
                        </p>
                        <font-awesome-icon :icon="isHelpTestShown ? 'minus' : 'plus'"
                          aria-hidden="false" focusable="true" aria-labelledby="expandCollapseVersionsAltText"/>
                      </span>
                  </button>
                </div>
              </div>
          </section>
      </div>
      <div v-if="isHelpTestShown" class="p-4 has-text-justified">
        <p>
          The <span class="has-text-weight-bold">Versions</span> section may contain a <span class="has-text-weight-bold">Default Status</span>
          field and one or more of these version status categories:
        </p>
        <div class="columns">
            <div v-for="status in ['Affected', 'Unaffected', 'Unknown']" :key="status.key"
              class="column cve-top-margin cve-versions-column">
              <div class="menu has-text-centered" style="border: unset !important">
                <span class="has-text-weight-bold">{{status}}</span> Versions List
              </div>
            </div>
          </div>
        <p>
          Each category contains a list with the following format:
          <ul>
            <li>
              Top-level
              <a href="https://github.com/CVEProject/cve-schema/blob/master/schema/v5.0/docs/versions.md#versions-and-version-ranges"
              target="_blank">version/version range</a> is marked with a solid circle bullet.
              <ul>
                <li>
                  <a href="https://github.com/CVEProject/cve-schema/blob/master/schema/v5.0/docs/versions.md#version-status-changes"
                  target="_blank">Version changes</a> are marked with an outlined circle bullet.
                </li>
              </ul>
            </li>
          </ul>
        </p>
        <p><span class="cve-version">Purple text</span> denotes the version provided by the user inputting the CVE JSON 5.0 data.</p>
      <!-- <h4 class="title">Version Details</h4> -->
        <p>
          In the following section you will find the descriptions, format information and examples for the following fields: default status,
          top-level version/version range and version changes.
        </p>
        <p class="is-size-5">Default Status</p>
        <p>
          This status applies to all versions not explicitly mentioned elsewhere.
          <a href="https://github.com/CVEProject/cve-schema/blob/master/schema/v5.0/docs/versions.md#version-status-decisions" target="_blank">
          Learn more.</a>
        </p>
        <p class="is-size-5">Top-level Version/Version Range</p>
        <p>The single version being described, or the version range. By convention, 0 typically denotes the earliest possible version.</p>
        <p class="is-size-6 has-text-weight-bold">Formats:</p>
        <ul>
          <li>
            &lt;status: affected, unaffected, unknown&gt; at <span class="cve-version">&lt;version&gt;</span>
          </li>
          <li>
            &lt;status: affected, unaffected, unknown&gt; from <span class="cve-version">&lt;start version&gt;</span> &lt;at, before, through&gt;
            <span class="cve-version">&lt;end version&gt;</span>
          </li>
        </ul>
        <p class="is-size-6 has-text-weight-bold">Examples:</p>
        <ul>
          <li>
            <span class="has-text-weight-bold">unknown at <span class="cve-version">5.0</span></span>
            <span class="is-italic"> (unknown version is 5.0)</span>
          </li>
          <li>
            <span class="has-text-weight-bold">
              affected from <span class="cve-version">5.0</span> before <span class="cve-version">6.0</span></span>
            <span class="is-italic"> (affected version doesn’t include 6.0)</span>
          </li>
          <li>
            <span class="has-text-weight-bold">
              unaffected from <span class="cve-version">5.0</span> through <span class="cve-version">6.0</span>
            </span>
            <span class="is-italic"> (unaffected version range includes 5.0 and 6.0)</span>
          </li>
        </ul>
        <p class="is-size-5">Version changes</p>
        <p>
          A list of status changes that take place during a range. The list should be sorted in (linearly or topologically) increasing order by the
          'at' field, according to the <span class="is-italic">versionType</span>, but the user must not assume this. Instead, users must re-sort
          the list themselves before using it.
        </p>
        <p class="is-size-6 has-text-weight-bold">Format:</p>
        <p>&lt;status: affected, unaffected, unknown&gt; from <span class="cve-version">&lt;version&gt;</span></p>
        <p class="is-size-6 has-text-weight-bold">Examples:</p>
        <ul>
          <li>
            <span class="has-text-weight-bold">affected from <span class="cve-version">1.0</span> before <span class="cve-version">4.0</span></span>
            <span class="is-italic"> (affected version doesn't include 4.0)</span>
            <ul>
              <li>
                <span class="has-text-weight-bold">unaffected from <span class="cve-version">1.0</span></span>
                <span class="is-italic"> (version affected changed and it is unaffected from 1.0 to 2.0 — the next range right below)</span>
              </li>
              <li>
                <span class="has-text-weight-bold">affected from <span class="cve-version">2.0</span></span>
                <span class="is-italic"> (version remain affected from 2.0 to before 4.0, not including 4.0)</span>
              </li>
            </ul>
          </li>
          <li>
            For another linear version example view the
            <a href="https://github.com/CVEProject/cve-schema/blob/master/schema/v5.0/docs/versions.md#version-status-changes" target="_blank">
              Version Status Changes
            </a> section
          </li>
          <li>
            For a non-linear version example view the
            <a href="https://github.com/CVEProject/cve-schema/blob/master/schema/v5.0/docs/versions.md#version-status-changes" target="_blank">
              Source Control Versions
            </a> section
          </li>
        </ul>
      </div>
    </div>
  </div> 
</template>

<script>
import _ from 'lodash';
import axios from 'axios';
import CvssCwe from '@/components/CvssCwe.vue';
import ProductStatus from '@/components/ProductStatus.vue';
import { useCveRecordLookupStore } from '@/stores/cveRecordLookup.ts';

export default {
  name: 'CveRecordUserGuide',
};
</script>

<style lang="scss" scoped>
@import '@/assets/style/globals.scss';
</style>
