<template>
  <div id="cve-secondary-page-main-container">
    <div class="columns is-centered">
      <div class="column is-8-desktop cve-main-column-content-width is-12-tablet">
        <main id="cve-main-page-content" role="main">
          <div class="content">
            <h1 class="title">Metrics</h1>
            <p>Use the scroll bar to navigate the data tables. </p>
            <div class="cve-white-bg-gray-border-container pt-2">
              <h2 :id="cvenavs['About']['submenu']['Metrics']['items']['Published CVE Records']['anchorId']" class="title">
                {{cvenavs['About']['submenu']['Metrics']['items']['Published CVE Records']['label']}}
              </h2>
              <p>Comparison of published <router-link to="/ResourcesSupport/Glossary?activeTerm=glossaryRecord">CVE Records
                </router-link> by quarter for all years from 1999 to present.
              </p>
              <p class="cve-help-text">
                A CVE Record contains descriptive data, (i.e., a brief description and at least one reference) about a
                <router-link to="/ResourcesSupport/Glossary?activeTerm=glossaryVulnerability">vulnerability</router-link> associated with
                a <router-link to="/ResourcesSupport/Glossary?activeTerm=glossaryCVEID">CVE ID</router-link>. CVE Records are published by
                <router-link to="/ResourcesSupport/Glossary?activeTerm=glossaryCNA">CVE Numbering Authorities (CNAs)</router-link>.
              </p>
              <div class="field is-grouped is-grouped-right">
                <label class="label">Sort by:</label>
                <div class="control">
                  <div class="select">
                    <select name="partner" v-model="publishedRecordsSortByYearSelectedOption" aria-label="select a sort by direction">
                      <option v-bind:value='"desc"'>Year (newest to oldest)</option>
                      <option v-bind:value='"asc"'>Year (oldest to newest)</option>
                    </select>
                  </div>
                </div>
              </div>
              <div class="cve-scrollx-table-container">
                <table class="table is-striped is-hoverable cve-border-dark-blue">
                  <thead>
                    <tr>
                      <th>Year</th>
                      <th v-for="year in publishedCveRecords.years" :key="year">{{year}}</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr v-for="quarter in ['4', '3', '2', '1']" :key="`published-${quarter}`">
                      <th>Qtr{{quarter}}</th>
                      <td v-for="value in publishedCveRecords.quarters[quarter]" :key="value.key">{{value}}</td>
                    </tr>
                    <tr>
                      <th>TOTAL</th>
                      <td v-for="total in publishedCveRecords.total" :key="total.key">{{total}}</td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </div>
            <div class="cve-white-bg-gray-border-container pt-2">
              <h2 :id="cvenavs['About']['submenu']['Metrics']['items']['Reserved CVE IDs']['anchorId']" class="title">
                {{cvenavs['About']['submenu']['Metrics']['items']['Reserved CVE IDs']['label']}}
              </h2>
              <p>
                Comparison of Reserved <router-link to="/ResourcesSupport/Glossary?activeTerm=glossaryCVEID">CVE IDs</router-link> by year from
                1999 to present.
              </p>
              <p class="cve-help-text">
                A “Reserved” CVE ID is the initial state for a <router-link to="/ResourcesSupport/Glossary?activeTerm=glossaryRecord">
                CVE Record</router-link>; when the associated CVE ID is reserved by a CNA.
              </p>
              <div class="field is-grouped is-grouped-right">
                <label class="label">Sort by:</label>
                <div class="control">
                  <div class="select">
                    <select name="partner" v-model="reservedIdsSortByYearSelectedOption" aria-label="select a sort by direction">
                      <option v-bind:value='"desc"'>Year (newest to oldest)</option>
                      <option v-bind:value='"asc"'>Year (oldest to newest)</option>
                    </select>
                  </div>
                </div>
              </div>
              <div class="cve-scrollx-table-container">
                <table class="table is-striped is-hoverable cve-border-dark-blue">
                  <thead>
                    <tr>
                      <th>Year</th>
                      <th v-for="year in reservedIds.years" :key="year">{{year}}</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <th>Count</th>
                      <td v-for="count in reservedIds.counts['all']" :key="count.key">{{count}}</td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </div>
            <!-- <div class="cve-white-bg-gray-border-container pt-2">
              <h2 :id="cvenavs['About']['submenu']['Metrics']['items']['Reserved but Public (RBP) CVE IDs']['anchorId']"
                class="title">
                {{cvenavs['About']['submenu']['Metrics']['items']['Reserved but Public (RBP) CVE IDs']['label']}}
              </h2>
              <p>
                Comparison of <router-link to="/ResourcesSupport/Glossary?activeTerm=glossaryRBP">Reserved but Public (RBP)</router-link> CVE IDs
                by quarter for all years from 2017 to present.
              </p>
              <p class="cve-help-text">
                An “RBP” is a <router-link to="/ResourcesSupport/Glossary?activeTerm=glossaryCVEID">CVE ID</router-link> in the Reserved state that
                is referenced in one or more public resources, but for which the details have not be published in a
                <router-link to="/ResourcesSupport/Glossary?activeTerm=glossaryRecord">CVE Record</router-link>.
              </p>
              <div class="cve-scrollx-table-container">
                <table class="table is-striped is-hoverable cve-border-dark-blue">
                  <thead>
                    <th>Year</th>
                    <th>2021</th>
                    <th>2020</th>
                    <th>2019</th>
                    <th>2018</th>
                    <th>2017</th>
                  </thead>
                  <tbody>
                    <tr>
                      <th>Qtr4</th>
                      <td>N/A</td>
                      <td>553</td>
                      <td>1,465</td>
                      <td>2,934</td>
                      <td>3,653</td>
                    </tr>
                    <tr>
                      <th>Qtr3</th>
                      <td>350</td>
                      <td>690</td>
                      <td>2,432</td>
                      <td>2,716</td>
                      <td>4,011</td>
                    </tr>
                    <tr>
                      <th>Qtr2</th>
                      <td>550</td>
                      <td>565</td>
                      <td>2,422</td>
                      <td>2,991</td>
                      <td>4,114</td>
                    </tr>
                    <tr>
                      <th>Qtr1</th>
                      <td>498</td>
                      <td>603</td>
                      <td>2,962</td>
                      <td>3,585</td>
                      <td>4,326</td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </div> -->
            <div class="cve-white-bg-gray-border-container pt-2">
              <h2 :id="cvenavs['About']['submenu']['Metrics']['items']['CVE Record Publications by All CNAs Combined Versus CNA-LRs']['anchorId']"
                class="title">
                {{cvenavs['About']['submenu']['Metrics']['items']['CVE Record Publications by All CNAs Combined Versus CNA-LRs']['label']}}
              </h2>
              <p>
                Comparison of <router-link to="/ResourcesSupport/Glossary?activeTerm=glossaryRecord">CVE Records</router-link> published by all
                <router-link to="/ResourcesSupport/Glossary?activeTerm=glossaryCNA">CNAs</router-link> combined versus CVE Records published by the
                two <router-link to="/ResourcesSupport/Glossary?activeTerm=glossaryCNALR">CNAs of Last Resort (CNA-LRs)</router-link>
                (<router-link to="/PartnerInformation/ListofPartners/partner/CISA">CISA</router-link><sup>*</sup> and
                <router-link to="/PartnerInformation/ListofPartners/partner/mitre"> MITRE</router-link>)
                from 1999 to present.
              </p>
              <div class="field is-grouped is-grouped-right">
                <label class="label">Sort by:</label>
                <div class="control">
                  <div class="select">
                    <select name="partner" v-model="recordPublicationsSortByYearSelectedOption" aria-label="select a sort by direction">
                      <option v-bind:value='"desc"'>Year (newest to oldest)</option>
                      <option v-bind:value='"asc"'>Year (oldest to newest)</option>
                    </select>
                  </div>
                </div>
              </div>
              <div class="cve-scrollx-table-container">
                <table class="table is-striped is-hoverable cve-border-dark-blue">
                    <thead>
                      <tr>
                        <th>Year</th>
                        <th v-for="year in recordPublications.years" :key="year.key">{{year}}</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <th>All CNAs</th>
                        <td v-for="percentage in recordPublications.countsByCnaType['All CNAs']" :key="percentage.key">{{percentage}}%</td>
                      </tr>
                      <tr>
                        <th>CNA-LRs</th>
                        <td v-for="percentage in recordPublications.countsByCnaType['CNA-LRs']" :key="percentage.key">{{percentage}}%</td>
                      </tr>
                  </tbody>
                </table>
                <p class="cve-help-text mt-3">*Note: CISA became a CNA-LR in calendar year 2020.</p>
              </div>
            </div>
            <div class="cve-white-bg-gray-border-container pt-2">
              <h2 :id="cvenavs['About']['submenu']['Metrics']['items']['CNA Partners Added by Year']['anchorId']" class="title">
                {{cvenavs['About']['submenu']['Metrics']['items']['CNA Partners Added by Year']['label']}}
              </h2>
              <p>
                Comparison of
                <router-link to="/ResourcesSupport/Glossary?activeTerm=glossaryCNA">
                  CVE Numbering Authority (CNA)
                </router-link>
                partners added by year from 1999 to present.
              </p>
              <p class="cve-help-text">
                Currently, there are
                <router-link to="/PartnerInformation/ListofPartners">
                  {{parseInt(usePartnerStoreInstance.role.CNA) + parseInt(usePartnerStoreInstance.role['CNA-LR'])}} CNAs
                </router-link>
                ({{usePartnerStoreInstance.role.CNA}} CNAs and {{usePartnerStoreInstance.role['CNA-LR']}} CNA-LRs) from
                <router-link to="/ProgramOrganization/CNAs#CNAProgramGrowth">
                  {{usePartnerStoreInstance.countriesCount}} countries
                </router-link>
                and 1 no country affiliation participating in the CVE Program.
              </p>
              <p class="cve-help-text">
                <span class="is-italic">Note: Occasionally, CNAs become inactive due to corporate mergers or changes in business activities.
                In these cases, deactivated CNAs</span> are not removed <span class="is-italic">from the recruitment total CNAs added for a
                calendar year in the table below. Therefore, the totals by year columns if added together will not match the program’s grand
                total numbers above.</span>
              </p>
              <div class="field is-grouped is-grouped-right">
                <label class="label">Sort by:</label>
                <div class="control">
                  <div class="select">
                    <select name="partner" v-model="partnerAddedSortByYearSelectedOption" aria-label="select a sort by direction">
                      <option v-bind:value='"desc"'>Year (newest to oldest)</option>
                      <option v-bind:value='"asc"'>Year (oldest to newest)</option>
                    </select>
                  </div>
                </div>
              </div>
              <div class="cve-scrollx-table-container">
                <table class="table is-striped is-hoverable cve-border-dark-blue">
                  <thead>
                    <th>Year</th>
                    <th v-for="year in cnasAddedByYear.years" :key="year">{{year}}</th>
                  </thead>
                  <tbody>
                    <tr v-for="month in [ 'January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October',
                      'November', 'December']" :key="`added-${month}`">
                      <th>{{month}}</th>
                      <td v-for="value in cnasAddedByYear.months[month]" :key="value.key">{{value}}</td>
                    </tr>
                    <tr>
                      <th>TOTAL</th>
                      <td v-for="total in cnasAddedByYear.total" :key="total.key">{{total}}</td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </div>
            <div class="cve-white-bg-gray-border-container pt-2">
              <h2 :id="cvenavs['About']['submenu']['Metrics']['items']['CNA Enrichment Recognition']['anchorId']" class="title">
                {{cvenavs['About']['submenu']['Metrics']['items']['CNA Enrichment Recognition']['label']}}
              </h2>
              <div>
                <p>
                  Getting more precise and quality vulnerability information in the hands of defenders and downstream customers
                  on a timelier basis helps the cybersecurity community better address risks. Additional vulnerability-related
                  information provides increased transparency, enables vulnerability root cause understanding, and helps prioritize
                  vulnerability and incident response. Information standards and knowledge repositories like
                  <a href="https://www.first.org/cvss/" target="_blank">CVSS</a>,
                  <a href="https://cwe.mitre.org/" target="_blank">CWE</a>,
                  and others help provide a common language for this additional information.
                </p>
                <p>
                  In April 2024, the CVE Program
                  <router-link to="/Media/News/item/blog/2024/04/30/New-CVE-Record-Format-Enables-Additional-Data">
                    highlighted how its data format evolved
                  </router-link>
                  to better facilitate automation and data enrichment.
                  This means that
                  <router-link to="/ProgramOrganization/CNAs">CNAs</router-link>,
                  as the authoritative source of vulnerability information within their scope, and those with access to the most reliable
                  source for accurate determinations, can easily provide data enrichment directly to a CVE Record, as opposed to waiting
                  for a third-party to do so in a less timely and potentially less accurate manner. As such, the CVE Program called on all
                  CNAs to provide this enrichment to their CVE Records directly, and, in so doing, contribute more substantially to the
                  vulnerability management process. Many have answered that call.
                </p>
                <p>
                  In recognition of these CNAs, the CVE Program publishes this “CNA Enrichment Recognition List” every two weeks. Currently,
                  CNAs are added to the list if they provide CVSS and CWE information 98% of the time or more within the two-week period of
                  their last published CVE Record. For more information about vulnerability information types like CVSS and CWE, see the
                  <router-link to="/CVERecord/UserGuide">CVE Record User Guide</router-link>.
                </p>
              </div>
              <h3 class="title">CNA Enrichment Recognition List</h3>
              <p class="cve-help-text"><span class="has-text-weight-bold">Last Updated: </span><time>October 7, 2024</time><br/>
              <span class="has-text-weight-bold">Total CNAs: </span>217</p>
              <div>
                <ul>
                  <li>9front Systems</li>
                  <li>Absolute Software</li>
                  <li>Acronis International GmbH</li>
                  <li>Adobe Systems Incorporated</li>
                  <li>AlgoSec</li>
                  <li>AMI</li>
                  <li>AppCheck Ltd.</li>
                  <li>Arista Networks, Inc.</li>
                  <li>Asea Brown Boveri Ltd.</li>
                  <li>ASR Microelectronics Co., Ltd.</li>
                  <li>Autodesk</li>
                  <li>Automotive Security Research Group (ASRG)</li>
                  <li>Avaya Inc.</li>
                  <li>Baicells Technologies Co., Ltd.</li>
                  <li>Baidu, Inc.</li>
                  <li>Baxter Healthcare</li>
                  <li>Becton, Dickinson and Company (BD)</li>
                  <li>BeyondTrust Inc.</li>
                  <li>Bitdefender</li>
                  <li>BlackBerry</li>
                  <li>Brocade Communications Systems, Inc.</li>
                  <li>Canon EMEA</li>
                  <li>Canon Inc.</li>
                  <li>Carrier Global Corporation</li>
                  <li>Cato Networks</li>
                  <li>CERT.PL</li>
                  <li>CERT@VDE</li>
                  <li>Check Point Software Technologies Ltd.</li>
                  <li>Checkmarx</li>
                  <li>Checkmk GmbH</li>
                  <li>Ciena Corporation</li>
                  <li>cirosec GmbH</li>
                  <li>Cisco Systems, Inc.</li>
                  <li>ClickHouse, Inc.</li>
                  <li>Cloudflare, Inc.</li>
                  <li>Concrete CMS</li>
                  <li>CyberDanube</li>
                  <li>Cybersecurity and Infrastructure Security Agency (CISA) U.S. Civilian Government</li>
                  <li>Dassault Systèmes</li>
                  <li>Dell EMC</li>
                  <li>Dfinity Foundation</li>
                  <li>DirectCyber</li>
                  <li>Docker Inc.</li>
                  <li>dotCMS LLC</li>
                  <li>Dragos, Inc.</li>
                  <li>Dutch Institute for Vulnerability Disclosure (DIVD)</li>
                  <li>Eaton</li>
                  <li>Eclipse Foundation</li>
                  <li>ELAN Microelectronics Corp.</li>
                  <li>Elastic</li>
                  <li>EnterpriseDB Corporation</li>
                  <li>Environmental Systems Research Institute, Inc. (Esri)</li>
                  <li>Ericsson</li>
                  <li>ESET, spol. s r.o.</li>
                  <li>EU Agency for Cybersecurity (ENISA)</li>
                  <li>Exodus Intelligence</li>
                  <li>F5 Networks</li>
                  <li>Fedora Project (Infrastructure Software)</li>
                  <li>Flexera Software LLC</li>
                  <li>Fluid Attacks</li>
                  <li>Forcepoint</li>
                  <li>ForgeRock, Inc.</li>
                  <li>Fortinet, Inc.</li>
                  <li>Fortra, LLC</li>
                  <li>Gallagher Group Ltd</li>
                  <li>GE Healthcare</li>
                  <li>Gitea Limited</li>
                  <li>GitHub (maintainer security advisories)</li>
                  <li>GitHub Inc, (Products Only)</li>
                  <li>GitLab Inc.</li>
                  <li>Glyph & Cog, LLC</li>
                  <li>Google LLC</li>
                  <li>Grafana Labs</li>
                  <li>Hallo Welt! GmbH</li>
                  <li>Hanwha Vision Co., Ltd.</li>
                  <li>HashiCorp Inc.</li>
                  <li>HeroDevs</li>
                  <li>HiddenLayer, Inc.</li>
                  <li>Hillstone Networks Inc.</li>
                  <li>Hitachi Energy</li>
                  <li>Hitachi Vantara</li>
                  <li>Hitachi, Ltd.</li>
                  <li>Honeywell International Inc.</li>
                  <li>HP Inc.</li>
                  <li>Huawei Technologies</li>
                  <li>HYPR Corp</li>
                  <li>IBM Corporation</li>
                  <li>ICS-CERT</li>
                  <li>IDEMIA</li>
                  <li>Indian Computer Emergency Response Team (CERT-In)</li>
                  <li>Intel Corporation</li>
                  <li>Israel National Cyber Directorate</li>
                  <li>Ivanti</li>
                  <li>JetBrains s.r.o.</li>
                  <li>Johnson Controls</li>
                  <li>Juniper Networks, Inc.</li>
                  <li>Kaspersky</li>
                  <li>KNIME AG</li>
                  <li>KrCERT/CC</li>
                  <li>Kubernetes</li>
                  <li>Lenovo Group Ltd.</li>
                  <li>Lexmark International Inc.</li>
                  <li>LG Electronics</li>
                  <li>Liferay, Inc.</li>
                  <li>Logitech</li>
                  <li>M-Files Corporation</li>
                  <li>ManageEngine</li>
                  <li>Mattermost, Inc</li>
                  <li>Mautic</li>
                  <li>Microchip Technology</li>
                  <li>Microsoft Corporation</li>
                  <li>Mitsubishi Electric Corporation</li>
                  <li>MongoDB</li>
                  <li>Moxa Inc.</li>
                  <li>N-able</li>
                  <li>National Cyber Security Centre - Netherlands (NCSC-NL)</li>
                  <li>National Cyber Security Centre SK-CERT</li>
                  <li>National Instruments</li>
                  <li>Netflix, Inc.</li>
                  <li>Netskope</li>
                  <li>Network Optix</li>
                  <li>NLnet Labs</li>
                  <li>NortonLifeLock Inc</li>
                  <li>Nozomi Networks Inc.</li>
                  <li>Nvidia Corporation</li>
                  <li>Octopus Deploy</li>
                  <li>Okta</li>
                  <li>ONEKEY GmbH</li>
                  <li>Open Design Alliance</li>
                  <li>Open-Xchange</li>
                  <li>OpenAnolis</li>
                  <li>openEuler</li>
                  <li>OpenHarmony</li>
                  <li>OpenText (formerly Micro Focus)</li>
                  <li>OTRS AG</li>
                  <li>Palantir Technologies</li>
                  <li>Palo Alto Networks</li>
                  <li>Panasonic Holdings Corporation</li>
                  <li>Pandora FMS</li>
                  <li>PaperCut Software Pty Ltd</li>
                  <li>Patchstack OÜ</li>
                  <li>Payara</li>
                  <li>Pegasystems</li>
                  <li>Pentraze Cybersecurity</li>
                  <li>Perforce (formerly Puppet)</li>
                  <li>Ping Identity Corporation</li>
                  <li>Progress Software Corporation</li>
                  <li>Proofpoint Inc.</li>
                  <li>Protect AI</li>
                  <li>Pure Storage, Inc.</li>
                  <li>QNAP Systems, Inc.</li>
                  <li>Qualcomm, Inc.</li>
                  <li>Qualys, Inc.</li>
                  <li>rami.io GmbH</li>
                  <li>Rapid7, Inc.</li>
                  <li>Robert Bosch GmbH</li>
                  <li>Rockwell Automation</li>
                  <li>SailPoint Technologies</li>
                  <li>Samsung TV & Appliance</li>
                  <li>SAP SE</li>
                  <li>SBA Research gGmbH</li>
                  <li>Schneider Electric SE</li>
                  <li>Schweitzer Engineering Laboratories, Inc.</li>
                  <li>Secomea</li>
                  <li>Security Risk Advisors</li>
                  <li>ServiceNow</li>
                  <li>SHENZHEN CoolKit Technology CO., LTD.</li>
                  <li>SICK AG</li>
                  <li>Siemens</li>
                  <li>Sierra Wireless Inc.</li>
                  <li>Silicon Labs</li>
                  <li>Snow Software</li>
                  <li>Snyk</li>
                  <li>SoftIron</li>
                  <li>SolarWinds</li>
                  <li>Sonatype Inc.</li>
                  <li>Sophos</li>
                  <li>Spanish National Cybersecurity Institute, S.A.</li>
                  <li>Splunk</li>
                  <li>STAR Labs SG Pte. Ltd.</li>
                  <li>Synaptics</li>
                  <li>Synology Inc.</li>
                  <li>Talos</li>
                  <li>TeamViewer Germany GmbH</li>
                  <li>Temporal Technologies Inc.</li>
                  <li>Tenable Network Security, Inc.</li>
                  <li>Thales Group</li>
                  <li>The Document Foundation</li>
                  <li>The Missing Link Australia (TML)</li>
                  <li>The OpenNMS Group</li>
                  <li>The Tcpdump Group</li>
                  <li>The Wikimedia Foundation</li>
                  <li>TianoCore.org</li>
                  <li>Tigera</li>
                  <li>Toshiba Corporation</li>
                  <li>TR-CERT (Computer Emergency Response Team of the Republic of Turkey)</li>
                  <li>Trellix</li>
                  <li>TWCERT/CC</li>
                  <li>upKeeper Solutions</li>
                  <li>VulDB</li>
                  <li>VulnCheck</li>
                  <li>WatchGuard Technologies, Inc.</li>
                  <li>Western Digital</li>
                  <li>Wiz, Inc.</li>
                  <li>Wordfence</li>
                  <li>Xiaomi Technology Co Ltd</li>
                  <li>Yandex N.V.</li>
                  <li>Yokogawa Group</li>
                  <li>Yugabyte, Inc.</li>
                  <li>Zabbix</li>
                  <li>Zephyr Project</li>
                  <li>Zero Day Initiative</li>
                  <li>Zoom Video Communications, Inc.</li>
                  <li>Zscaler, Inc.</li>
                  <li>ZTE Corporation</li>
                  <li>ZUSO Advanced Research Team (ZUSO ART)</li>
                  <li>Zyxel Corporation</li>
                </ul>
              </div>
            </div>
          </div>
          <SurveyLinkComponent :surveyLink="cvenavs['About']['submenu']['Metrics']['surveyLink']" />
        </main>
      </div>
      <div class="column is-3 is-hidden-touch">
        <NavigationSidebar :nav="cvenavs['About']" />
      </div>
    </div>
  </div>
</template>

<script>
import NavigationSidebar from '@/components/NavigationSidebar.vue';
import SurveyLinkComponent from '@/components/SurveyLinkComponent.vue';
import MetricsData from '@/assets/data/metrics.json';
import { usePartnerStore } from '@/stores/partners';

export default {
  name: 'Metrics',
  components: {
    NavigationSidebar,
    SurveyLinkComponent,
  },
  props: {
    cvenavs: {
      type: Object,
      required: true,
    },
  },
  data() {
    return {
      publishedRecordsSortByYearSelectedOption: 'desc',
      reservedIdsSortByYearSelectedOption: 'desc',
      recordPublicationsSortByYearSelectedOption: 'desc',
      partnerAddedSortByYearSelectedOption: 'desc',
      publishedCveRecords: {},
      reservedIds: {},
      recordPublications: {},
      cnasAddedByYear: {}
    };
  },
  created() {
    this.getSortedPublishedCveRecords('desc');
    this.getSortedReseredCveIds('desc');
    this.getSortedRecordPublications('desc');
    this.getSortedPartnerAddedByYear('desc');
  },
  computed: {
    usePartnerStoreInstance() {
      return usePartnerStore().partnerCounts;
    }
  },
  watch: {
    publishedRecordsSortByYearSelectedOption() {
      this.getSortedPublishedCveRecords();
    },
    reservedIdsSortByYearSelectedOption() {
      this.getSortedReseredCveIds();
    },
    recordPublicationsSortByYearSelectedOption() {
      this.getSortedRecordPublications();
    },
    partnerAddedSortByYearSelectedOption() {
      this.getSortedPartnerAddedByYear();
    },
  },
  methods: {
    sortMetricsDataByYear(data, sortDirection) {
      const sortModifier = sortDirection === 'asc' ? 1 : -1;
      data.sort((annualData1, annualData2) => {
        if (annualData1.year < annualData2.year) return -1 * sortModifier;
        if (annualData1.year > annualData2.year) return 1 * sortModifier;

        return 0;
      });
    },
    getSortedPublishedCveRecords() {
      const publishedCveRecords = { years: [], quarters: {}, total: [] };
      const metrics = MetricsData.publishedCveRecords;
      this.sortMetricsDataByYear(metrics, this.publishedRecordsSortByYearSelectedOption);

      metrics.forEach((annualData) => {
        publishedCveRecords.years.push(annualData.year);

        let total = 0;
        annualData.data.forEach((data) => {
          if (!Object.prototype.hasOwnProperty.call(publishedCveRecords.quarters, data.quarter)) {
            publishedCveRecords.quarters[data.quarter] = [];
          }
          publishedCveRecords.quarters[data.quarter].push(data.value);

          total += /\d/.test(data.value) ? parseInt(data.value.replace(/,/, ''), 10) : 0;
        });
        publishedCveRecords.total.push(Intl.NumberFormat('en-US').format(total));
      });

      this.publishedCveRecords = publishedCveRecords;
    },
    getSortedReseredCveIds() {
      const sortedReservedIdsByYear = { years: [], counts: {} };
      const metrics = MetricsData.reservedCveIds;
      this.sortMetricsDataByYear(metrics, this.reservedIdsSortByYearSelectedOption);

      metrics.forEach((annualData) => {
        sortedReservedIdsByYear.years.push(annualData.year);

        annualData.data.forEach((data) => {
          if (!Object.prototype.hasOwnProperty.call(sortedReservedIdsByYear.counts, data.quarter)) {
            sortedReservedIdsByYear.counts[data.quarter] = [];
          }
          sortedReservedIdsByYear.counts[data.quarter].push(data.value);
        });
      });

      this.reservedIds = sortedReservedIdsByYear;
    },
    getSortedRecordPublications() {
      const sortedRecordPublications = { years: [], countsByCnaType: {} };
      const metrics = MetricsData.cveRecordPublications;
      this.sortMetricsDataByYear(metrics, this.recordPublicationsSortByYearSelectedOption);

      metrics.forEach((annualData) => {
        if (annualData.year > 2015) {
          sortedRecordPublications.years.push(annualData.year);

          annualData.data.forEach((data) => {
            if (!Object.prototype.hasOwnProperty.call(sortedRecordPublications.countsByCnaType, data.heading)) {
              sortedRecordPublications.countsByCnaType[data.heading] = [];
            }
            sortedRecordPublications.countsByCnaType[data.heading].push(data.percentage);
          });
        }
      });

      if (this.recordPublicationsSortByYearSelectedOption === 'asc') {
        sortedRecordPublications.years[0] = '1999-2016';
      } else {
        sortedRecordPublications.years[sortedRecordPublications.years.length - 1] = '2016-1999';
      }

      this.recordPublications = sortedRecordPublications;
    },
    getSortedPartnerAddedByYear() {
      const cnasAddedByYear = { years: [], months: {}, total: [] };
      const metrics = MetricsData.cnasAddedByYear;
      this.sortMetricsDataByYear(metrics, this.partnerAddedSortByYearSelectedOption);

      metrics.forEach((annualData) => {
        cnasAddedByYear.years.push(annualData.year);

        let total = 0;
        annualData.data.forEach((data) => {
          if (!Object.prototype.hasOwnProperty.call(cnasAddedByYear.months, data.month)) {
            cnasAddedByYear.months[data.month] = [];
          }
          cnasAddedByYear.months[data.month].push(data.value);

          total += /\d/.test(data.value) ? parseInt(data.value.replace(/,/, ''), 10) : 0;
        });
        cnasAddedByYear.total.push(Intl.NumberFormat('en-US').format(total));
      });

      this.cnasAddedByYear = cnasAddedByYear;
    },
  },
};
</script>

<style lang="scss">
  @import '../../assets/style/globals.scss'; 
</style>

<!-- Add "scoped" attribute to limit CSS to this component only -->
<style scoped lang="scss">
//Equally space data cells in metrics tables
td {
  width: auto !important;
}
</style>
