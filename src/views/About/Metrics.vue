<template>
  <div id="cve-secondary-page-main-container">
    <div class="columns is-centered">
      <div class="column is-8-desktop cve-main-column-content-width is-12-tablet">
        <main id="cve-main-page-content" role="main">
          <div class="content">
            <h1 class="title">Metrics</h1>
            <p>Use the scroll bar to navigate the data tables. </p>
            <div class="cve-white-bg-gray-border-container">
              <h2 :id="cvenavs['About']['submenu']['Metrics']['items']['Published CVE Records']['anchorId']" class="title cve-heading-top-spacing">
                {{cvenavs['About']['submenu']['Metrics']['items']['Published CVE Records']['label']}}
              </h2>
              <p>Comparison of published <router-link to="/ResourcesSupport/Glossary?activeTerm=glossaryRecord">CVE Records
                </router-link> by quarter for all years from 1999 to present.
              </p>
              <p class="cve-help-text">
                A CVE Record contains descriptive data, (i.e., a brief description and at least one reference) about a
                <router-link to="/ResourcesSupport/Glossary?activeTerm=glossaryVulnerability">vulnerability</router-link> associated with
                a <router-link to="/ResourcesSupport/Glossary?activeTerm=glossaryCVEID">CVE ID</router-link>. CVE Records are published by
                <router-link to="/ResourcesSupport/Glossary?activeTerm=glossaryCNA">CVE Numbering Authorities (CNAs)</router-link>.
              </p>
              <div class="cve-scrollx-table-container">
                <table class="table is-striped is-hoverable cve-border-dark-blue">
                  <thead>
                    <th>Year</th>
                    <th>2021</th>
                    <th>2020</th>
                    <th>2019</th>
                    <th>2018</th>
                    <th>2017</th>
                    <th>2016</th>
                    <th>2015</th>
                    <th>2014</th>
                    <th>2013</th>
                    <th>2012</th>
                    <th>2011</th>
                    <th>2010</th>
                    <th>2009</th>
                    <th>2008</th>
                    <th>2007</th>
                    <th>2006</th>
                    <th>2005</th>
                    <th>2004</th>
                    <th>2003</th>
                    <th>2002</th>
                    <th>2001</th>
                    <th>2000</th>
                    <th>1999</th>
                  </thead>
                  <tbody>
                    <tr>
                      <th>Qtr4</th>
                      <td>5,200</td>
                      <td>4,387</td>
                      <td>4,822</td>
                      <td>3,614</td>
                      <td>3,570</td>
                      <td>1,590</td>
                      <td>1,652</td>
                      <td>2,528</td>
                      <td>1,416</td>
                      <td>1,244</td>
                      <td>1,133</td>
                      <td>1,071</td>
                      <td>1,100</td>
                      <td>1,500</td>
                      <td>1,884</td>
                      <td>1,737</td>
                      <td>1,725</td>
                      <td>376</td>
                      <td>154</td>
                      <td>104</td>
                      <td>81</td>
                      <td>393</td>
                      <td>0</td>
                    </tr>
                    <tr>
                      <th>Qtr3</th>
                      <td>5,541</td>
                      <td>4,170</td>
                      <td>5,150</td>
                      <td>4,350</td>
                      <td>4,037</td>
                      <td>1,713</td>
                      <td>1,747</td>
                      <td>2,220</td>
                      <td>1,297</td>
                      <td>1,926</td>
                      <td>988</td>
                      <td>1,020</td>
                      <td>1,547</td>
                      <td>1,343 </td>
                      <td>1,564 </td>
                      <td>1,643</td>
                      <td>1,477</td>
                      <td>741</td>
                      <td>265</td>
                      <td>304</td>
                      <td>573</td>
                      <td>218</td>
                      <td>321</td>
                    </tr>
                    <tr>
                      <th>Qtr2</th>
                      <td>5,005</td>
                      <td>5,011</td>
                      <td>4,091</td>
                      <td>4,613</td>
                      <td>3,612</td>
                      <td>1,775</td>
                      <td>1,443</td>
                      <td>1,660</td>
                      <td>1,147</td>
                      <td>1,058</td>
                      <td>901</td>
                      <td>1,408</td>
                      <td>1,381</td>
                      <td>1,279</td>
                      <td>1,887 </td>
                      <td>1,887</td>
                      <td>2,013</td>
                      <td>229</td>
                      <td>630 </td>
                      <td>593 </td>
                      <td>337</td>
                      <td>198</td>
                      <td>0</td>
                    </tr>
                    <tr>
                      <th>Qtr1</th>
                      <td>4,415</td>
                      <td>4,807</td>
                      <td>3,245</td>
                      <td>3,935</td>
                      <td>3,426</td>
                      <td>1,379</td>
                      <td>1,652</td>
                      <td>1,540</td>
                      <td>1,282</td>
                      <td>1,060</td>
                      <td>1,128</td>
                      <td>1,140</td>
                      <td>1,704</td>
                      <td>1,551</td>
                      <td>1,987</td>
                      <td>1,618</td>
                      <td>1,493</td>
                      <td>266</td>
                      <td>174</td>
                      <td>690</td>
                      <td>332</td>
                      <td>629</td>
                      <td>0</td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </div>
            <div class="cve-white-bg-gray-border-container">
              <h2 :id="cvenavs['About']['submenu']['Metrics']['items']['Reserved CVE IDs']['anchorId']" class="title cve-heading-top-spacing">
                {{cvenavs['About']['submenu']['Metrics']['items']['Reserved CVE IDs']['label']}}
              </h2>
              <p>
                Comparison of Reserved <router-link to="/ResourcesSupport/Glossary?activeTerm=glossaryCVEID">CVE IDs</router-link> by year from
                1999 to present.
              </p>
              <p class="cve-help-text">
                A “Reserved” CVE ID is the initial state for a <router-link to="/ResourcesSupport/Glossary?activeTerm=glossaryRecord">
                CVE Record</router-link>; when the associated CVE ID is reserved by a CNA.
              </p>
              <div class="cve-scrollx-table-container">
                <table class="table is-striped is-hoverable cve-border-dark-blue">
                  <thead>
                    <th>Year</th>
                    <th>2021</th>
                    <th>2020</th>
                    <th>2019</th>
                    <th>2018</th>
                    <th>2017</th>
                    <th>2016</th>
                    <th>2015</th>
                    <th>2014</th>
                    <th>2013</th>
                    <th>2012</th>
                    <th>2011</th>
                    <th>2010</th>
                    <th>2009</th>
                    <th>2008</th>
                    <th>2007</th>
                    <th>2006</th>
                    <th>2005</th>
                    <th>2004</th>
                    <th>2003</th>
                    <th>2002</th>
                    <th>2001</th>
                    <th>2000</th>
                    <th>1999</th>
                  </thead>
                  <tbody>
                    <tr>
                      <th>Count</th>
                      <td>21,855</td>
                      <td>30,680</td>
                      <td>24,179</td>
                      <td>21,407</td>
                      <td>18,196</td>
                      <td>14,472</td>
                      <td>9,959</td>
                      <td>9,465</td>
                      <td>7,334</td>
                      <td>7,370</td>
                      <td>5,630</td>
                      <td>5,379</td>
                      <td>5,630</td>
                      <td>5,968</td>
                      <td>7,607</td>
                      <td>7,077</td>
                      <td>7,041</td>
                      <td>1,357</td>
                      <td>1,209</td>
                      <td>1,909</td>
                      <td>1,445</td>
                      <td>1,178</td>
                      <td>991</td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </div>
            <div class="cve-white-bg-gray-border-container">
              <h2 :id="cvenavs['About']['submenu']['Metrics']['items']['Reserved but Public (RBP) CVE IDs']['anchorId']"
                class="title cve-heading-top-spacing">
                {{cvenavs['About']['submenu']['Metrics']['items']['Reserved but Public (RBP) CVE IDs']['label']}}
              </h2>
              <p>
                Comparison of <router-link to="/ResourcesSupport/Glossary?activeTerm=glossaryRBP">Reserved but Public (RBP)</router-link> CVE IDs
                by quarter for all years from 2017 to present.
              </p>
              <p class="cve-help-text">
                An “RBP” is a <router-link to="/ResourcesSupport/Glossary?activeTerm=glossaryCVEID">CVE ID</router-link> in the Reserved state that
                is referenced in one or more public resources, but for which the details have not be published in a
                <router-link to="/ResourcesSupport/Glossary?activeTerm=glossaryRecord">CVE Record</router-link>.
              </p>
              <div class="cve-scrollx-table-container">
                <table class="table is-striped is-hoverable cve-border-dark-blue">
                  <thead>
                    <th>Year</th>
                    <th>2021</th>
                    <th>2020</th>
                    <th>2019</th>
                    <th>2018</th>
                    <th>2017</th>
                  </thead>
                  <tbody>
                    <tr>
                      <th>Qtr4</th>
                      <td>N/A</td>
                      <td>553</td>
                      <td>1,465</td>
                      <td>2,934</td>
                      <td>3,653</td>
                    </tr>
                    <tr>
                      <th>Qtr3</th>
                      <td>350</td>
                      <td>690</td>
                      <td>2,432</td>
                      <td>2,716</td>
                      <td>4,011</td>
                    </tr>
                    <tr>
                      <th>Qtr2</th>
                      <td>550</td>
                      <td>565</td>
                      <td>2,422</td>
                      <td>2,991</td>
                      <td>4,114</td>
                    </tr>
                    <tr>
                      <th>Qtr1</th>
                      <td>498</td>
                      <td>603</td>
                      <td>2,962</td>
                      <td>3,585</td>
                      <td>4,326</td>
                    </tr>
                  </tbody>
                </table>
              </div>
            </div>
            <div class="cve-white-bg-gray-border-container">
              <h2 :id="cvenavs['About']['submenu']['Metrics']['items']['CVE Record Publications by All CNAs Combined Versus CNA-LR']['anchorId']"
                class="title cve-heading-top-spacing">
                {{cvenavs['About']['submenu']['Metrics']['items']['CVE Record Publications by All CNAs Combined Versus CNA-LR']['label']}}
              </h2>
              <p>
                Comparison of <router-link to="/ResourcesSupport/Glossary?activeTerm=glossaryRecord">CVE Records</router-link> published by all
                <router-link to="/ResourcesSupport/Glossary?activeTerm=glossaryCNA">CNAs</router-link> combined versus CVE Records published by the
                <router-link to="/ResourcesSupport/Glossary?activeTerm=glossaryCNALR">CNA of Last Resort (CNA-LR)</router-link>
                (<router-link to="/PartnerInformation/ListofPartners/partner/icscert">CIS ICS</router-link> and
                <router-link to="/PartnerInformation/ListofPartners/partner/mitre"> MITRE</router-link>)
                from 1999 to present.
              </p>
              <div class="cve-scrollx-table-container">
                <table class="table is-striped is-hoverable cve-border-dark-blue">
                    <thead>
                    <tr>
                        <th>Year</th>
                        <th>2021</th>
                        <th>2020</th>
                        <th>2019</th>
                        <th>2018</th>
                        <th>2017</th>
                        <th>2016-1999</th>
                    </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <th>All CNAs</th>
                        <td>65%</td>
                        <td>58%</td>
                        <td>53%</td>
                        <td>53%</td>
                        <td>50%</td>
                        <td>0%</td>
                      </tr>
                      <tr>
                        <th>CISA ICS CNA-LR<sup>*</sup></th>
                        <td>4%</td>
                        <td>&lt;1%</td>
                        <td>0%</td>
                        <td>0%</td>
                        <td>0%</td>
                        <td>0%</td>
                      </tr>
                      <tr>
                        <th>MITRE CNA-LR</th>
                        <td>34%</td>
                        <td>42%</td>
                        <td>47%</td>
                        <td>47%</td>
                        <td>50%</td>
                        <td>100%</td>
                      </tr>
                  </tbody>
                </table>
                <p class="cve-help-text mt-3">*Note: CISA ICS became a Top-Level Root and CNA-LR in calendar year 2020</p>
              </div>
            </div>
          </div>
          <SurveyLinkComponent :surveyLink="cvenavs['About']['submenu']['Metrics']['surveyLink']" />
        </main>
      </div>
      <div class="column is-3 is-hidden-touch">
        <NavigationSidebar :nav="cvenavs['About']" />
      </div>
    </div>
  </div>
</template>

<script>
import NavigationSidebar from '@/components/NavigationSidebar.vue';
import SurveyLinkComponent from '@/components/SurveyLinkComponent.vue';

export default {
  name: 'Metrics',
  components: {
    NavigationSidebar,
    SurveyLinkComponent,
  },
  props: {
    cvenavs: {
      type: Object,
      required: true,
    },
  },
  data() {
    return {
      imgAltText: {
        publishedCVERecord: 'Stacked bar chart showing count of published CVE records by year between 1999 and 2020 where each quarter is stacked'
        + 'from Q1 on the bottom to Q4 on the top.',
        reservedCVEIDs: 'Bar chart showing count of reserved CVE IDs by year between 1999 and 2000',
        rbp: 'Stacked bar chart showing steady decline of reserved CVE IDs which were referenced publically but not published in a CVE for 4 years '
        + 'from 2017 to 2000 by quarter. Count for before 2017 is on bottom of bar and count for after 2017 is on top of bar.',
        idStateChange: 'This bar chart shows the number of Reserved CVE IDs, Reserved but Public (RBP) CVE IDs, Published CVE Records, and Rejected '
        + 'CVE IDs by quarter for years between 2018 and 2000',
        cnaWhoPublisehed: 'Bar chart showing count of CNAs who published a CVE Record by month for the 4 years of 2017 and 2020',
      },
    };
  },
};
</script>

<!-- Add "scoped" attribute to limit CSS to this component only -->
<style scoped lang="scss">
@import '../../assets/style/globals.scss';
//Equally space data cells in metrics tables
td {
  width: auto !important;
}
</style>
