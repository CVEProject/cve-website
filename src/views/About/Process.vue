<template>
  <div id="cve-secondary-page-main-container" class="container">
    <div class="columns is-centered">
      <div class="column is-8-desktop cve-main-column-content-width is-12-tablet">
        <main id="cve-main-page-content" role="main">
          <div class="content">
            <h1 class="title">Process</h1>
            <p>
              There is one <router-link to='/ResourcesSupport/Glossary?activeTerm=glossaryRecord'>CVE Record</router-link> for each vulnerability on
              the <router-link to='/ResourcesSupport/Glossary?activeTerm=glossaryCVEList'>CVE List</router-link>. Vulnerabilities are first
              discovered, then reported to the CVE Program. The reporter requests a
              <router-link to='/ResourcesSupport/Glossary?activeTerm=glossaryCVEID'>CVE ID</router-link>,
              which is then reserved for the reported vulnerability. Once the reported vulnerability is
              confirmed by the identification of the minimum required data elements for a CVE Record, the record is published to the CVE List.
              CVE Records are published by CVE Program partners from around the world. This process is described below.
            </p>
            <h2 :id="cvenavs['About']['submenu']['Process']['items']['CVE Record Lifecycle']['anchorId']" class="title cve-heading-top-spacing">
              {{cvenavs['About']['submenu']['Process']['items']['CVE Record Lifecycle']['label']}}
            </h2>
            <div class="cve-round-edges-black-border cve-dark-purple-bg">
              <figure class="image cve-no-margin" >
                <img src="@/assets/images/CVERecordLifeyclnfographic.jpg" alt="CVE record lifecycle is a six step process"/>
              </figure>
            </div>

            <div class="timeline">
              <header class="timeline-header">
                <span class="tag is-medium">Start</span>
              </header>
              <div class="timeline-item">
                <div class="timeline-marker">1</div>
                <div class="timeline-content">
                  <h3 class="title">Discover</h3>
                  <p>A person or organization discovers a new vulnerability</p>
                </div>
              </div>
              <div class="timeline-item">
                <div class="timeline-marker is-3">2</div>
                <div class="timeline-content">
                  <h3 class="title">Report</h3>
                  <p>Discoverer reports a vulnerability to a CVE Program participant</p>
                </div>
              </div>
              <div class="timeline-item">
                <div class="timeline-marker">3</div>
                <div class="timeline-content">
                  <h3 class="title">Request</h3>
                  <p>CVE Program participant requests a CVE Identifier (CVE ID)</p>
                  <section class="cve-accordion">
                    <div class="message">
                      <div class="message-header">
                        <h4 class="title">CVE ID</h4>
                        <button class="button" @click="toggleAccordionItem('cve-id')"
                          :aria-expanded="!accordion['cve-id'] ? 'true' : 'false'"
                          aria-controls="cve-id">
                          <span class="icon is-small">
                            <p id="cve-id-alttext" class="is-hidden">
                              {{accordion['cve-id'] ? 'collapse' : 'expand'}}
                            </p>
                            <font-awesome-icon :icon="accordion['cve-id'] ? 'plus' : 'minus'"
                            aria-hidden="false" focusable="true" aria-labelledby="cve-id-alttext"/>
                          </span>
                        </button>
                      </div>
                      <div class="message-body" :class="{'is-hidden': accordion['cve-id']}" id="cve-id">
                        <div class="block">
                          <p>
                            A CVE ID is a unique, alphanumeric identifier assigned by the CVE Program. Each identifier references a specific
                            <router-link to='/ResourcesSupport/Glossary?activeTerm=glossaryVulnerability'>vulnerability</router-link>.
                          </p>
                          <p>CVE IDs have the following format:</p>
                          <p class="has-text-centered has-text-weight-bold">CVE prefix + Year + Arbitrary Digits</p>
                          <p>
                            The “Year” portion is the year that the CVE ID was reserved or the year the vulnerability was made public. The year
                            portion is not used to indicate when the vulnerability was discovered.
                          </p>
                          <p>
                            The “Arbitrary Digits,” or sequence number portion, can include four or more digits in the sequence number portion of the
                            ID. For example, <span class="has-text-weight-bold">CVE-YYYY-NNNN</span> with four digits in the sequence number,
                            <span class="has-text-weight-bold">CVE-YYYY-NNNNNNN</span> with seven digits in the sequence
                            number, etc. There is no limit on the number of arbitrary digits.
                          </p>
                          <p>The CVE Program’s CNA Rules include additional helpful information about CVE IDs:</p>
                          <p>
                            <router-link to='/ResourcesSupport/AllResources/CNARules#section_7_assignment_rules'>Assignment Rules</router-link>
                            - how CVE IDs are assigned.
                          </p>
                        </div>
                      </div>
                    </div>
                  </section>
                </div>
              </div>
              <div class="timeline-item is-5">
                <div class="timeline-marker">4</div>
                <div class="timeline-content">
                  <h3 class="title">Reserve</h3>
                  <p>Discoverer reports a vulnerability to a CVE Program participant</p>
                </div>
              </div>
              <div class="timeline-item">
                <div class="timeline-marker">5</div>
                <div class="timeline-content">
                  <h3 class="title">Submit</h3>
                  <p>CVE Program participant submits the details</p>
                </div>
              </div>
              <div class="timeline-item pb-5">
                <div class="timeline-marker">6</div>
                <div class="timeline-content">
                  <h3 class="title">Publish</h3>
                  <p>The CVE Record is available for download and viewing by the public.</p>
                  <section class="cve-accordion">
                    <div class="message">
                      <div class="message-header">
                        <h4 class="title">CVE Records</h4>
                        <button class="button" @click="toggleAccordionItem('cve-record')"
                          :aria-expanded="!accordion['cve-record'] ? 'true' : 'false'"
                          aria-controls="cve-record">
                          <span class="icon is-small">
                            <p id="cve-record-alttext" class="is-hidden">
                              {{accordion['cve-record'] ? 'collapse' : 'expand'}}
                            </p>
                            <font-awesome-icon :icon="accordion['cve-record'] ? 'plus' : 'minus'"
                              aria-hidden="false" focusable="true" aria-labelledby="cve-record-alttext"/>
                          </span>
                        </button>
                      </div>
                      <div class="message-body" :class="{'is-hidden': accordion['cve-record']}" id="cve-record">
                        <div class="block">
                          <p>A CVE Record is the descriptive data about a vulnerability associated with a CVE ID, provided by a CVE Numbering
                            Authority (<router-link to='/ResourcesSupport/Glossary?activeTerm=glossaryCNA'>CNA</router-link>). This data is provided
                            in multiple human and machine-readable formats.
                          </p>
                          <p>Each CVE Record includes the following:</p>
                          <ol>
                            <li>CVE ID with four or more digits in the sequence number portion of the ID (i.e., “CVE-1999-0067”, “CVE-2019-12345”,
                              “CVE-2021-7654321”).</li>
                            <li>Brief Description of the security vulnerability.</li>
                            <li>Any pertinent References (i.e., vulnerability reports and advisories).</li>
                          </ol>
                          <p>A CVE Record is associated with one of the following states:</p>
                          <ul>
                            <li>
                              <span class="has-text-weight-bold">Reserved:</span>
                              The initial state for a CVE Record; when the associated CVE ID is Reserved by a CNA.</li>
                            <li>
                              <span class="has-text-weight-bold">Published:</span>
                              When a CNA populates the data associated with a CVE ID as a CVE Record, the state of the CVE Record is
                              Published. The associated data must contain an identification number (CVE ID), a prose description, and at least one
                              public reference.
                            </li>
                            <li>
                              <span class="has-text-weight-bold">Rejected:</span>
                              If the CVE ID and associated CVE Record should no longer be used, the CVE Record is placed in the Rejected
                              state. A Rejected CVE Record remains on the CVE List so that users can know when it is invalid.</li>
                          </ul>
                          <p>The CVE Program’s CNA Rules includes additional helpful information about CVE Records: </p>
                          <ul>
                            <li>
                              <router-link to='/ResourcesSupport/AllResources/CNARules#section_8-1_cve_entry_information_requirements'>
                                CVE Record Information Requirements
                              </router-link> – the full requirements for a CVE Record.
                            </li>
                            <li>
                              <router-link to='/ResourcesSupport/AllResources/CNARules#section_7_assignment_rules'>Assignment Rules</router-link>
                              – the data elements required within a CVE Record.
                            </li>
                          </ul>
                        </div>
                      </div>
                    </div>
                  </section>
                </div>
              </div>
              <footer class="timeline-header">
                <span class="tag is-medium">End</span>
              </footer>
            </div>
            <SurveyLinkComponent :surveyLink="cvenavs['About']['submenu']['Process']['surveyLink']" />
          </div>
        </main>
      </div>
      <div class="column is-3 is-hidden-touch">
        <NavigationSidebar :nav="cvenavs['About']" />
      </div>
    </div>
  </div>
</template>

<script>
import Vue from 'vue';
import NavigationSidebar from '@/components/NavigationSidebar.vue';
import SurveyLinkComponent from '@/components/SurveyLinkComponent.vue';

export default {
  name: 'Process',
  components: {
    NavigationSidebar,
    SurveyLinkComponent,
  },
  props: {
    cvenavs: {
      type: Object,
      required: true,
    },
  },
  data() {
    return {
      accordion: { 'cve-id': true, 'cve-record': true },
    };
  },
  methods: {
    toggleAccordionItem(id) {
      Vue.set(this.accordion, id, !this.accordion[id]);
    },
  },
};
</script>

<!-- Add "scoped" attribute to limit CSS to this component only -->
<style scoped lang="scss">
@import '../../assets/style/globals.scss';
@import 'bulma';
@import 'bulma-timeline';

.button {
  border-color: white;
}

.button:focus {
  outline: none;
}

.button:hover {
  border: none;
}
</style>
