<template>
  <div id="cve-secondary-page-main-container">
    <div class="columns is-centered">
      <div class="column is-6">
        <main id="cve-main-page-content" role="main">
          <div class="content">
            <h1 class="title">Process</h1>
            <h2 :id="cvenavs['About']['submenu']['CVE Process']['items']['Overview']" class="title">Overview</h2>
            <p>
              There is one CVE Record for each vulnerability on the CVE List. Vulnerabilities are first discovered, and once reported to the CVE
              Program, the reporter requests a CVE ID, which is then reserved for the reported vulnerability. Once the reported vulnerability is
              confirmed by the identification of the minimum required data elements for a CVE Record, the record is published to the CVE list.
              CVE Records are published by CVE Program partners from around the world. This process is described below.
            </p>

            <h2 :id="cvenavs['About']['submenu']['CVE Process']['items']['CVE Record Lifecycle']" class="title">CVE Record Lifecycle</h2>
            <div style="background-color: #2F2A47;">
              <figure class="image" >
                <img src="@/assets/images/CVELifeCyclnfographic.png"/>
              </figure>
            </div>

            <div class="timeline">
              <header class="timeline-header">
                <span class="tag is-medium">Start</span>
              </header>
              <div class="timeline-item">
                <div class="timeline-marker">1</div>
                <div class="timeline-content">
                  <h3 class="title">Discover</h3>
                  <p>A person or organization discovers a new vulnerability</p>
                </div>
              </div>
              <div class="timeline-item">
                <div class="timeline-marker is-3">2</div>
                <div class="timeline-content">
                  <h3 class="title">Report</h3>
                  <p>Discoverer reports a vulnerability to a CVE Program participant</p>
                </div>
              </div>
              <div class="timeline-item">
                <div class="timeline-marker">3</div>
                <div class="timeline-content">
                  <h3 class="title">Request</h3>
                  <p>CVE Program participant requests a <router-link to="/About/Glossary">CVE Identifier (CVE ID)</router-link></p>
                  <section class="cve-accordian">
                    <div class="message">
                      <div class="message-header">
                        <h4 class="title">CVE ID</h4>
                        <button class="button" @click="toggleAccordianItem('cve-id')">
                          <span class="icon is-small">
                            <font-awesome-icon icon="minus"/>
                          </span>
                        </button>
                      </div>
                      <div class="message-body" :class="{'is-hidden': accordian['cve-id']}">
                        <div class="block">
                          <p>
                            A CVE ID is a unique, alphanumeric identifier assigned by the CVE Program. Each identifier references a specific
                            vulnerability.
                          </p>
                          <p>CVE IDs have the following format:</p>
                          <p class="has-text-centered ">CVE prefix + Year + Arbitrary Digits</p>
                          <p>The “Year” portion is the year that the CVE ID was reserved or the year the vulnerability was made public.. The year
                            portion is not used to indicate when the vulnerability was discovered. </p>
                          <p>
                            The “Arbitrary Digits,” or sequence number portion, can include four or more digits in the sequence number portion of the
                            ID. For example, CVE-YYYY-NNNN with four digits in the sequence number, CVE-YYYY-NNNNNNN with seven digits in the sequence
                            number, etc. There is no limit on the number of arbitrary digits.
                          </p>
                          <p>The CVE Program’s CNA Rules include additional helpful information about CVE IDs:</p>
                          <p>Assignment Rules - how CVE IDs are assigned.</p>

                        </div>
                      </div>
                    </div>
                  </section>
                </div>
              </div>
              <div class="timeline-item is-5">
                <div class="timeline-marker">4</div>
                <div class="timeline-content">
                  <h3 class="title">Reserve</h3>
                  <p>Discoverer reports a vulnerability to a CVE Program participant</p>
                </div>
              </div>
              <div class="timeline-item">
                <div class="timeline-marker">5</div>
                <div class="timeline-content">
                  <h3 class="title">Submit</h3>
                  <p>CVE Program participant submits the details</p>
                </div>
              </div>
              <div class="timeline-item pb-5">
                <div class="timeline-marker">6</div>
                <div class="timeline-content">
                  <h3 class="title">Publish</h3>
                  <p>The CVE record is available for download and viewing by the public.</p>
                  <section class="cve-accordian">
                    <div class="message">
                      <div class="message-header">
                        <h4 class="title">CVE Records</h4>
                        <button class="button" @click="toggleAccordianItem('cve-record')">
                          <span class="icon is-small">
                            <font-awesome-icon icon="minus"/>
                          </span>
                        </button>
                      </div>
                      <div class="message-body" :class="{'is-hidden': accordian['cve-record']}">
                        <div class="block">
                          <p>A CVE Record is the descriptive data about a vulnerability associated with a CVE ID, provided by a
                            CVE Numbering Authority (CNA), and enriched by Authorized
                            Data Publishers (ADPs). This data is provided in multiple human and machine-readable formats. </p>
                          <p>Each CVE Record includes the following:</p>
                          <ol>
                            <li>CVE ID with four or more digits in the sequence number portion of the ID (i.e., “CVE-1999-0067”,
                            “CVE-2019-12345”, “CVE-2021-7654321”).</li>
                            <li>Brief Description of the security vulnerability.</li>
                            <li>Any pertinent References (i.e., vulnerability reports and advisories).</li>
                          </ol>
                          <p>A CVE Record is associated with one of the following states:</p>
                          <ul>
                            <li>Reserved: The initial state for a CVE Record; when the associated CVE ID is Reserved by a CNA.</li>
                            <li>Published: When a CNA populates the data associated with a CVE ID as a CVE Record, the state of the
                              CVE Record is Published. The associated data must contain
                              an identification number (CVE ID), a prose description, and at least one public reference.</li>
                            <li>Rejected: If the CVE ID and associated CVE Record should no longer be used, the CVE Record is placed
                              in the Rejected state. A Rejected CVE Record remains on
                              the CVE List so that users can know when it is invalid.</li>
                          </ul>
                          <p>The CVE Program’s CNA Rules includes additional helpful information about CVE Records: </p>
                          <ul>
                            <li>CVE Record Information Requirements – the full requirements for a CVE Record.</li>
                            <li>Assignment Rules – the data elements required within a CVE Record.</li>
                          </ul>
                        </div>
                      </div>
                    </div>
                  </section>
                </div>
              </div>
              <footer class="timeline-header">
                <span class="tag is-medium">End</span>
              </footer>
            </div>
          </div>
        </main>
      </div>
      <div class="column is-3">
        <NavigationSidebar :nav="cvenavs['About']" />
      </div>
    </div>
  </div>
</template>

<script>
import Vue from 'vue';
import NavigationSidebar from '@/components/NavigationSidebar.vue';

export default {
  name: 'Process',
  components: {
    NavigationSidebar,
  },
  props: {
    cvenavs: {
      type: Object,
      required: true,
    },
  },
  data() {
    return {
      accordian: { 'cve-id': true, 'cve-record': true },
    };
  },
  methods: {
    toggleAccordianItem(id) {
      Vue.set(this.accordian, id, !this.accordian[id]);
    },
  },
};
</script>

<!-- Add "scoped" attribute to limit CSS to this component only -->
<style scoped lang="scss">
@import '../../assets/style/globals.scss';
@import 'bulma';
@import 'bulma-timeline';

.content h1, h2, h3, h4, h5, h6 {
  color: black !important;
}

.timeline .timeline-item .timeline-marker {
  background-color: white !important;
}

.timeline-content {
  width: 90%;
}

.button {
  border-color: white;
}

.button:focus {
  outline: none;
}

.button:hover {
  border: none;
}
</style>
