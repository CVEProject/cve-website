<template>
  <div id="cpeCweCvss">
      <div id="cve-cpe">
        <slot></slot>
        <p class="title is-6">CPE</p>
        <ul>
          <li v-for="cpe in cpes">{{ cpe }}</li>
        </ul>
      </div>
  </div>
</template>
  
  <script>
  export default {
    props: {
      containerObject: {
        type: Object,
        required: true,
      },
    },
    data() {
      return {
        cpes: []
      }
    },
    methods: {
      getCpes() {
        this.containerObject.affected.forEach( (affectedVersion) => {
          if (affectedVersion?.cpes) {
            affectedVersion.cpes.forEach( (cpe) => {
              this.cpes.push(cpe);
            });
          }
        });
      },
    },
    beforeMount() {
      this.getCpes();
    }
  };
  </script>
  
  <!-- Add "scoped" attribute to limit CSS to this component only -->
  <style scoped lang="scss">
  @import '../assets/style/globals.scss';
  
  </style>
  